!function(t){var e={};function r(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(i,s,function(e){return t[e]}.bind(null,s));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){"use strict";r.r(e);function i(t){return t[t.length-1]}function s(t){return t.length>1}function a(t){for(var e=[],r=1;r<t.length;r++)try{var i=t[r].split("</div>")[0].split("background-image:url(")[1].split(")")[0];e.push(i)}catch(t){}return e}var l=async(t,e)=>{if("compact"==e)var r=!0,l=!1;else if("minimum"==e)r=!1,l=!0;else r=!1,l=!1;try{const e=encodeURI(t);console.log("Product details initiated");try{var p=await(await fetch("https://www.flipkart.com/"+e)).text();if(s((p=p.replace(/&amp;/g,"&")).split("for has been moved or deleted")))throw"Link provided doesn't corresponds to any product"}catch(t){return JSON.stringify({error_message:t,possible_solution:"Validate your link and try removing https://www.flipkart.com from your product link",bug_report:"https://github.com/dvishal485/flipkart-scraper-api/issues"})}var c,n=null,o=null,h=null,u=null,d=[];if(p.split("<h1").length>1)u=p.split("<h1")[1].split("</span>")[0].split('">')[2].replace(/<!-- -->/g,"").replace(/&nbsp;/g,"");else u=p.split('class="B_NuCI"')[1].split("</span>")[0].split(">")[1].replace(/<!-- -->/g,"").replace(/&nbsp;/g,"");try{o=p.split("<h1")[1].split(">₹")[1].split("</div>")[0]}catch(t){o=null}try{var g=p.split("<h1")[1].split(">₹")[2].split("</div>")[0].split("\x3c!-- --\x3e"),m=s(g)}catch(t){m=!1}var f=p.split("height:64px"),v=[];if((s(f)||s(f=p.split("_20Gt85 _1Y"))||s(f=p.split("_2r_T1I")))&&(v=a(f)),0==v.length)try{var y=u.replace(/&#x27;/g,"'").split("(")[0].trim();console.log(y);var w=p.split(`alt="${y}"`);console.log(w),w=w[1].split('src="')[1].split('"')[0],v.push(w)}catch(t){}try{var _=p.split("<h1")[1].split("Product Description")[0].split("fk-cp-zion/img/fa_62673a.png"),k=s(_)}catch(t){k=s(p.split("Product Description")[0].split("fk-cp-zion/img/fa_62673a.png"))}try{o=parseInt(o.replace(/,/g,"")),c=m?parseInt(g[1].replace(/,/g,"")):o}catch(t){c=null}try{"/"==(h=i(i((i(p.split("product.share.pp")[0].split('"url":"'))+"product.share.pp").split(" ")).split('"')))[0]&&(h="http://www.flipkart.com"+h),String(h).toLowerCase().split("login").length>1&&(h="http://www.flipkart.com/"+e)}catch(t){h="http://www.flipkart.com/"+e}var b=new URL(h);b.searchParams.delete("_appId"),b.searchParams.delete("_refId"),b.searchParams.delete("cmpid"),h=b.toString();var P=s(p.split("This item is currently out of stock</div>"))||s(p.split("Coming Soon</div>"));try{var I=p.split("Highlights")[1].split("</ul>")[0].replace(/<\/li>/g,"").split("<li");if(s(I))for(var M=1;M<I.length;M++)try{d.push(I[M].split(">")[1])}catch(t){}}catch(t){d=[]}var S=_[0].split("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMyIgaGVpZ2h0PSIxMiI+PHBhdGggZmlsbD0iI0ZGRiIgZD0iTTYuNSA5LjQzOWwtMy42NzQgMi4yMy45NC00LjI2LTMuMjEtMi44ODMgNC4yNTQtLjQwNEw2LjUuMTEybDEuNjkgNC4wMSA0LjI1NC40MDQtMy4yMSAyLjg4Mi45NCA0LjI2eiIvPjwvc3ZnPg==");if(s(S))n=i(S[0].split('">')).split("<")[0];else try{n=p.split("_3LWZlK")[1].split("<")[0].split(">")[1].trim()}catch(t){}if((null==o||null==o||NaN==o||o<1)&&(o=parseInt(p.split("_30jeq3 _16Jk6d")[1].split("</div>")[0].split(">")[1].replace(/₹/g,"").replace(/,/g,""))),(null==c||null==c||NaN==c||c<1)&&(c=parseInt(p.split("_3I9_wc _2p6lqe")[1].split("</div>")[0].split(">")[1].replace(/₹/g,"").replace(/,/g,""))),l)return JSON.stringify({name:u.replace(/&#x27;/g,"'"),current_price:o,original_price:c,discounted:m,discount_percent:parseInt(100*(1-o/c)),rating:n,in_stock:!P,f_assured:k,share_url:h,thumbnails:v,highlights:d},null,2);var N=[];try{var x=p.split("Specifications</div>")[1].split(">Safe and Secure Payments.")[0].replace(/&amp;/g,"&").split("</div><table")}catch(t){x=[]}for(M=1;M<x.length;M++)try{var C,L="",j=[],T=i(x[M-1].split(">")),R=x[M].split("</td>");for(C=1;C<R.length;C+=2)try{var D=i(R[C-1].split(">")),Z=i(R[C].split("</li>")[0].split(">"));null!=D&&""!=D&&1==Z.split("<").length&&""!=Z&&(r?L+=D+" : "+Z+"; ":j.push({property:D,value:Z}))}catch(t){}j!=[]&&(r?N.push({title:T,details:L}):N.push({title:T,details:j}))}catch(t){}return JSON.stringify({name:u.replace(/&#x27;/g,"'"),current_price:o,original_price:c,discounted:m,discount_percent:parseInt(100*(1-o/c)),rating:n,in_stock:!P,f_assured:k,share_url:h,thumbnails:v,highlights:d,specs:N},null,2)}catch(t){return JSON.stringify({error:"Couldn't fetch information : "+t.message,possible_solution:"Don't lose hope, contact the support",bug_report:"https://github.com/dvishal485/flipkart-scraper-api/issues"})}};const p=t=>{var e=new URL(t.replace(/amp;/g,""));return e.searchParams.delete("_appId"),e.searchParams.delete("_refId"),e.searchParams.delete("cmpid"),e.searchParams.delete("marketplace"),e.searchParams.delete("ppt"),e.searchParams.delete("lid"),e.searchParams.delete("store"),e.searchParams.delete("spotlightTagId"),e.searchParams.delete("q"),e.searchParams.delete("srno"),e.searchParams.delete("otracker"),e.searchParams.delete("fm"),e.searchParams.delete("iid"),e.searchParams.delete("ppn"),e.searchParams.delete("ssid"),e.searchParams.delete("qH"),e.toString()};var c=async t=>{const e="https://www.flipkart.com/search?marketplace=FLIPKART&q="+t;console.log("Search initiated : "+e);var r,i=await(await fetch(e)).text(),s=(i=i.replace(/style="color:#000000;font-size:14px;font-style:normal;font-weight:700">₹/g,">Rs. ")).split(">₹"),a=[],l=null,c=!1;for(r=1;r<s.length;r++)try{var n,o=null,h=null,u=null,d=!1,g=null,m=null,f=null,v=s[r].split("</div>")[0].replace(/,/g,"");if(n=parseInt(v),1==v.split("</option>").length){try{(f=(m=s[r-1].split("</a>"))[m.length-2].split('target="_blank"')).length>1&&(h="https://www.flipkart.com"+f[1].split('href="')[1].split('"')[0],u=f[1].split('href="')[1].split('"')[1].split(">")[1],l="A")}catch(t){}if(o=parseInt(n),""==u||null==u){m=null,f=null;try{"C"!=l&&"D"!=l||(r++,c=!0),m=s[r-2].split("<a"),l="B",1==m.length&&(m=s[r-1].split("<a"),l="C"),(f=m[m.length-1].split('target="_blank"')).length>1&&(h="https://www.flipkart.com"+f[1].split('href="')[1].split('"')[0],u=f[1].split('href="')[1].split('"col col-7-12">')[1].split("</div>")[0].split(">")[1]),c&&(r--,c=!1,l="D")}catch(t){}if(""==u||null==u);else{try{g=i.split(`alt="${u}"`)[1].split('src="')[1].split('"')[0]}catch(t){g=null}if(r+1!=s.length)(d=(y=s[r+1].split("</div>")[0].replace(/,/g,"").split("\x3c!-- --\x3e")).length>1)&&(r++,o=parseInt(y[1]));a.push({name:u.replace(/&#x27;/g,"'"),link:p(h),current_price:n,original_price:o,discounted:d,thumbnail:g})}}else{try{g=i.split(`alt="${u}"`)[1].split('src="')[1].split('"')[0]}catch(t){g=[]}var y;if(r+1!=s.length)(d=(y=s[r+1].split("</div>")[0].replace(/,/g,"").split("\x3c!-- --\x3e")).length>1)&&(r++,o=parseInt(y[1]));a.push({name:u.replace(/&#x27;/g,"'"),link:p(h),current_price:n,original_price:o,discounted:d,thumbnail:g})}}else i=i.replace("₹","Rs."),console.log("Ignoring amount "+n+" : Suspected to be dropdown menu item")}catch(t){console.log(t.message)}return JSON.stringify({result:a},null,2)};var n=t=>({"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"*","Access-Control-Allow-Methods":"GET","Access-Control-Max-Age":"86400","Content-Type":"application/json","Cache-Control":"no-cache, no-store, must-revalidate","Your-IP":t.get("cf-connecting-ip"),"Your-Country":t.get("CF-IPCountry"),Host:t.get("host"),"Made-By":atob("VmlzaGFsIERhcyBodHRwczovL2dpdGh1Yi5jb20vZHZpc2hhbDQ4NQ==")});function o(t){return t[t.length-1]}function h(t){return t.length>1}function u(t,e,r){var i=!1;e=e.toLowerCase(),t=t.toLowerCase();for(var s=0;s<r.length;s++)if(r[s]=r[s].toLowerCase(),h(t.split(r[s]))||h(e.split(r[s])))return i=!0;return i}function d(t){for(var e=[],r=1;r<t.length;r++)try{var i=t[r].split("</div>")[0].split("background-image:url(")[1].split(")")[0];e.push(i)}catch(t){}return e}var g=async t=>{try{var e=t.split("/")[0];t=t.split(e+"/")[1];var r=e.split("&");const D=encodeURI(t);console.log("Product details initiated");try{var i=await(await fetch("https://www.flipkart.com/"+D)).text();if(h((i=i.replace(/&amp;/g,"&")).split("for has been moved or deleted")))throw"Link provided doesn't corresponds to any product"}catch(t){return JSON.stringify({error_message:t,possible_solution:"Validate your link and try removing https://www.flipkart.com from your product link",bug_report:"https://github.com/dvishal485/flipkart-scraper-api/issues"})}var s,a=null,l=null,p=null,c=null,n=[];if(i.split("<h1").length>1)c=i.split("<h1")[1].split("</span>")[0].split('">')[2].replace(/<!-- -->/g,"").replace(/&nbsp;/g,"");else c=i.split('class="B_NuCI"')[1].split("</span>")[0].split(">")[1].replace(/<!-- -->/g,"").replace(/&nbsp;/g,"");try{l=i.split("<h1")[1].split(">₹")[1].split("</div>")[0]}catch(t){l=null}try{var g=i.split("<h1")[1].split(">₹")[2].split("</div>")[0].split("\x3c!-- --\x3e"),m=h(g)}catch(t){m=!1}var f=i.split("height:64px"),v=[];if((h(f)||h(f=i.split("_20Gt85 _1Y"))||h(f=i.split("_2r_T1I")))&&(v=d(f)),0==v.length)try{var y=c.replace(/&#x27;/g,"'").split("(")[0].trim();console.log(y);var w=i.split(`alt="${y}"`);console.log(w),w=w[1].split('src="')[1].split('"')[0],v.push(w)}catch(t){}try{var _=i.split("<h1")[1].split("Product Description")[0].split("fk-cp-zion/img/fa_62673a.png"),k=h(_)}catch(t){k=h(i.split("Product Description")[0].split("fk-cp-zion/img/fa_62673a.png"))}try{l=parseInt(l.replace(/,/g,"")),s=m?parseInt(g[1].replace(/,/g,"")):l}catch(t){s=null}try{"/"==(p=o(o((o(i.split("product.share.pp")[0].split('"url":"'))+"product.share.pp").split(" ")).split('"')))[0]&&(p="http://www.flipkart.com"+p),String(p).toLowerCase().split("login").length>1&&(p="http://www.flipkart.com/"+D)}catch(t){p="http://www.flipkart.com/"+D}var b=new URL(p);b.searchParams.delete("_appId"),b.searchParams.delete("_refId"),b.searchParams.delete("cmpid"),p=b.toString();var P=h(i.split("This item is currently out of stock</div>"))||h(i.split("Coming Soon</div>"));try{var I=i.split("Highlights")[1].split("</ul>")[0].replace(/<\/li>/g,"").split("<li");if(h(I))for(var M=1;M<I.length;M++)try{n.push(I[M].split(">")[1])}catch(t){}}catch(t){n=[]}var S=_[0].split("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMyIgaGVpZ2h0PSIxMiI+PHBhdGggZmlsbD0iI0ZGRiIgZD0iTTYuNSA5LjQzOWwtMy42NzQgMi4yMy45NC00LjI2LTMuMjEtMi44ODMgNC4yNTQtLjQwNEw2LjUuMTEybDEuNjkgNC4wMSA0LjI1NC40MDQtMy4yMSAyLjg4Mi45NCA0LjI2eiIvPjwvc3ZnPg==");if(h(S))a=o(S[0].split('">')).split("<")[0];else try{a=i.split("_3LWZlK")[1].split("<")[0].split(">")[1].trim()}catch(t){}(null==l||null==l||NaN==l||l<1)&&(l=parseInt(i.split("_30jeq3 _16Jk6d")[1].split("</div>")[0].split(">")[1].replace(/₹/g,"").replace(/,/g,""))),(null==s||null==s||NaN==s||s<1)&&(s=parseInt(i.split("_3I9_wc _2p6lqe")[1].split("</div>")[0].split(">")[1].replace(/₹/g,"").replace(/,/g,"")));var N=[],x=[];try{var C=i.split("Specifications</div>")[1].split(">Safe and Secure Payments.")[0].replace(/&amp;/g,"&").split("</div><table")}catch{C=[]}for(M=1;M<C.length;M++)try{var L,j=C[M].split("</td>");for(L=1;L<j.length;L+=2)try{var T=o(j[L-1].split(">")),R=o(j[L].split("</li>")[0].split(">"));null==T&&""==T||u(R,T,r)&&x.push({property:T,value:R})}catch(t){}0!=x.length&&(N=x)}catch(t){}return JSON.stringify({name:c.replace(/&#x27;/g,"'"),current_price:l,original_price:s,discounted:m,discount_percent:parseInt(100*(1-l/s)),rating:a,in_stock:!P,f_assured:k,share_url:p,thumbnails:v,highlights:n,desired_specs:N},null,2)}catch(t){return JSON.stringify({error:"Couldn't fetch information : "+t.message,possible_solution:"Don't lose hope, contact the support",bug_report:"https://github.com/dvishal485/flipkart-scraper-api/issues"})}};addEventListener("fetch",t=>{t.respondWith(async function(t){const e=n(t.headers),r=new URL(t.url).pathname;return"GET"==t.method?r.startsWith("/search/")?new Response(await c(r.replace("/search/","")),{status:200,headers:e}):r.startsWith("/product/min/")?new Response(await l(r.replace("/product/min/",""),"minimum"),{status:200,headers:e}):r.startsWith("/product/compact/")?new Response(await l(r.replace("/product/compact/",""),"compact"),{status:200,headers:e}):r.startsWith("/product/")?new Response(await l(r.replace("/product/",""),"general"),{status:200,headers:e}):r.startsWith("/property/")?new Response(await g(r.replace("/property/",""),"general"),{status:200,headers:e}):new Response(JSON.stringify([{name:"flipkart-scraper",description:"API to scrapes search result and product details from flipkart",version:2.1,author:"Vishal Das",email:"dvishal485@gmail.com",telegram:"@dvishal485",documentation:"https://dvishal485.github.io/flipkart-scraper-api/",usage:{search_api:"https://flipkart.dvishal485.workers.dev/search/<product_name>",product_api:"https://flipkart.dvishal485.workers.dev/product/<product_link_argument>",product_min_api:"https://flipkart.dvishal485.workers.dev/product/min/<product_link_argument>",product_compact_api:"https://flipkart.dvishal485.workers.dev/product/compact/<product_link_argument>",product_search_specs:"https://flipkart.dvishal485.workers.dev/property/<specs_to_search>/<product_link_argument>"},examples:{search_api:"https://flipkart.dvishal485.workers.dev/search/smartwatch",product_api:"https://flipkart.dvishal485.workers.dev/product/dl/huami-amazfit-bip-u-smartwatch/p/itmc6ae7a0e9f440?pid=SMWFY7PPGQTEH2BZ",product_min_api:"https://flipkart.dvishal485.workers.dev/product/min/dl/huami-amazfit-bip-u-smartwatch/p/itmc6ae7a0e9f440?pid=SMWFY7PPGQTEH2BZ",product_compact_api:"https://flipkart.dvishal485.workers.dev/product/compact/dl/huami-amazfit-bip-u-smartwatch/p/itmc6ae7a0e9f440?pid=SMWFY7PPGQTEH2BZ",product_search_specs:"https://flipkart.dvishal485.workers.dev/property/battery&display/dl/huami-amazfit-bip-u-smartwatch/p/itmc6ae7a0e9f440?pid=SMWFY7PPGQTEH2BZ"}}],null,2),{status:200,headers:e}):Response.redirect("https://github.com/dvishal485/flipkart-scraper/",301)}(t.request))})}]);